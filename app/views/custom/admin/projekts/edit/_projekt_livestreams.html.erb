<h2><%= t("custom.admin.projekts.edit.projekt_livestreams_tab.page_title") %></h2>

<%= render partial: 'custom/admin/projekts/edit/projekt_livestreams/form', locals: { url: admin_projekt_projekt_livestreams_path(@projekt), projekt: @projekt, livestream: @projekt_livestream } %>

<div class='margin-top'>
  <% if @projekt_livestreams.present? %>
    <h3 class="projekt-all-livestream-list"><%= t('custom.admin.projekts.edit.projekt_livestreams_tab.all_livestreams') %></h2>
  <% end %>

  <% @projekt_livestreams.each do |livestream| %>
    <div class='small-12 medium-7 projekt-livestream' id="<%= dom_id(livestream) %>">
      <%= check_box_tag "edit_projekt_event_#{ dom_id(livestream) }" %>
      <%= label_tag nil, nil, for: "edit_projekt_event_#{ dom_id(livestream) }", class: 'edit-projekt-livestream' %>

      <div class='projekt-livestream-content'>
        <% if livestream.from_youtube? %>
          <%= image_tag("https://img.youtube.com/vi/#{livestream.external_id}/hqdefault.jpg", referrerpolicy: 'no-referrer') %>
        <% elsif livestream.from_vimeo? && livestream.preview_image_url.present? %>
          <%= image_tag(livestream.preview_image_url, referrerpolicy: 'no-referrer') %>
        <% end %>

        <p>
          <strong><%= t('custom.admin.projekts.edit.projekt_livestreams_tab.livestream.url') %>:</strong>
          <%= link_to(livestream.url, livestream.url) %>
        </p>
        <% if livestream.title.present? %>
          <p>
            <strong><%= t('custom.admin.projekts.edit.projekt_livestreams_tab.livestream.title') %>:</strong>
            <%= livestream.title %>
          </p>
        <% end %>
        <p>
          <strong><%= t('custom.admin.projekts.edit.projekt_livestreams_tab.livestream.platform') %>:</strong>
          <%= livestream.platform_formated %>
        </p>
        <p>
        <% if livestream.starts_at.present? %>
          <p>
            <strong><%= t('custom.admin.projekts.edit.projekt_livestreams_tab.livestream.starts_at') %>:</strong>
            <%= livestream.starts_at&.strftime('%d.%m.%y %H:%m') %>
          </p>
        <% end %>
        <% if livestream.description.present? %>
          <p>
            <strong><%= t('custom.admin.projekts.edit.projekt_livestreams_tab.livestream.description') %>:</strong>
            <%= truncate(livestream.description, length: 500) %>
          </p>
        <% end %>
      </div>

      <div class='edit-projekt-livestream-form'>
        <%= render partial: 'custom/admin/projekts/edit/projekt_livestreams/form', locals: { url: admin_projekt_projekt_livestream_path(@projekt, livestream), projekt: @projekt, livestream: livestream } %>
      </div>

      <%= link_to '', admin_projekt_projekt_livestream_path(@projekt, livestream, namespace: @namespace), method: :delete, class: 'delete-projekt-livestream' %>
      <hr>
    </div>
  <% end %>
</div>
