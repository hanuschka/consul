<div class="flex-column">
  <div class="layout-left-column">
    <%# <%= render Shared::MobileResourcesFilterComponent.new( sdgs: @sdgs, categories: @categories,
    <%#   resource_name: @resource_name,
    <%#   geozones: @geozones,
    <%#   projekts_filter_variables: {
    <%#     top_level_active_projekts: @top_level_active_projekts,
    <%#     top_level_archived_projekts: @top_level_archived_projekts,
    <%#     scoped_projekt_ids: @scoped_projekt_ids,
    <%#     all_resources: @all_resources,
    <%#     current_tab_phase: @current_tab_phase,
    <%#     current_projekt: @current_projekt
    <%#   }
    <%# ) %>

    <% if controller_name == 'debates' %>
      <% if feature?("user.recommendations") && @recommended_debates.present? %>
        <%= render "shared/recommended_index", recommended: @recommended_debates,
          disable_recommendations_path: recommendations_disable_debates_path,
          namespace: "debates" %>
      <% end %>

      <% if extended_feature?("debates.intro_text_for_debates") %>
        <%= render_custom_block 'debates_welcome' %>
      <% end %>

      <% unless @search_terms || !has_featured? %>
        <%= render "featured_debates" %>
      <% end %>
    <% end %>

    <% if extended_feature?('modulewide.custom_help_text_in_modules') %>
      <%= link_to t('debates.index.section_header.help'), '#section_help' %>
    <% end %>

    <%= render 'shared/loader_spinner' %>
      <% if @current_projekt&.overview_page? %>
      <% elsif controller_name == 'debates' %>
        <% debates_load_url = debates_path %>
      <% else %>
        <% debates_load_url = url_for(action: params[:current_tab_path], controller: "/pages", format: :js) %>
      <% end %>

      <%= render(
            Shared::ResourcesList.new(
              resources: @debates,
              resource_type: Debate,
              remote_url: debates_load_url,
              current_filter: @current_order,
              filter_param: "order",
              filters: @valid_orders,
              no_items_text: "No debates"
            ))
      %>
    <%= paginate @debates, remote: true, params: { controller: 'pages', action: 'debate_phase_footer_tab' } %>
  </div>

  <div id="debates-sidebar" class="sidebar">

    <% if controller_name == 'debates' %>
      <%= render Shared::NewButtonComponent.new(resources_name: "debates", query_params: params) %>
    <% else %>
      <%= render Shared::NewButtonComponent.new(projekt_phase: @current_tab_phase) %>
    <% end %>

    <% if controller_name == 'debates' %>
      <%= render Shared::SidebarCardComponent.new(title: 'Export', icon_name: "tag") do |c| %>
        <% c.body do %>
          <%=
            link_to t("admin.budget_investments.index.download_current_selection"),
              admin_debates_path(csv_params),
              target: '_blank'
            %>
        <% end %>
      <% end %>
    <% end %>

    <% unless @current_projekt&.overview_page? %>
      <%= render Sidebar::ProjektsFilterComponent.new(
        top_level_active_projekts: @top_level_active_projekts,
        top_level_archived_projekts: @top_level_archived_projekts,
        scoped_projekt_ids: @scoped_projekt_ids,
        all_resources: @all_resources,
        current_tab_phase: @current_tab_phase,
        current_projekt: @current_projekt
      ) %>
    <% end %>

    <%= render "shared/sidebar_filter/geozone_affiliations", resource_name: @resource_name, geozones: @geozones %>
    <%= render "shared/categories", taggable: "projekt", categories: @categories, projekt_footer_mode: true %>
    <%= render SDG::Goals::TagCloudComponentCustom.new("Projekt", sdg_targets: @sdg_targets) %>

    <% if extended_feature?('debates.enable_my_posts_filter') %>
      <%= render "shared/sidebar_filter/my_posts" %>
    <% end %>
  </div>
</div>


