<%= render 'shared/loader_spinner' %>

<div class="layout-main-column">
  <div class="layout-left-column">

    <%= render Shared::MobileResourcesFilterComponent.new(
      sdgs: @sdgs,
      categories: @categories,
      resource_name: @resource_name,
      projekts_filter_variables: {
        top_level_active_projekts: @top_level_active_projekts,
        top_level_archived_projekts: @top_level_archived_projekts,
        scoped_projekt_ids: @scoped_projekt_ids,
        all_resources: @all_resources,
        current_tab_phase: @current_tab_phase,
        current_projekt: @current_projekt
      }
    ) %>
    <%= render 'shared/loader_spinner' %>

      <% if @current_projekt.overview_page? %>

      <% else %>
        <% proposal_footer_url = url_for(action: params[:current_tab_path], controller: "/pages", format: :js) %>
      <% end %>
      <%= render(
            Shared::ResourcesList.new(
              resources: @proposals,
              title: 'Proposals',
              load_resources_url: proposal_footer_url,
              map_coordinates: @proposals_coordinates,
              current_filter: @current_order,
              filter_param: "order",
              filters: @valid_orders,
              no_items_text: "No proposals"
            ))
      %>
    <% if @current_projekt.overview_page? %>
      <%= paginate @proposals, remote: true, params: { controller: 'projekts', action: 'proposal_phase_footer_tab' } %>
    <% else %>
      <%= paginate @proposals, remote: true, params: { controller: 'pages', action: 'proposal_phase_footer_tab' } %>
    <% end %>
  </div>

  <div id="proposals-sidebar" class="sidebar">
    <%= render Shared::NewButtonComponent.new(projekt_phase: @current_tab_phase) %>

    <% unless @current_projekt.overview_page? %>
      <%= render Sidebar::ProjektsFilterComponent.new(
        top_level_active_projekts: @top_level_active_projekts,
        top_level_archived_projekts: @top_level_archived_projekts,
        scoped_projekt_ids: @scoped_projekt_ids,
        all_resources: @all_resources,
        current_tab_phase: @current_tab_phase,
        current_projekt: @current_projekt
      ) %>
    <% end %>

    <%= render "shared/sidebar_filter/geozone_affiliations", resource_name: @resource_name, geozones: @geozones %>
    <%= render "shared/categories", taggable: "projekt", categories: @categories, projekt_footer_mode: true %>
    <%= render SDG::Goals::TagCloudComponentCustom.new("Projekt", sdg_targets: @sdg_targets) %>
  </div>
</div>
