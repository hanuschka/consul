<%= render 'shared/loader_spinner' %>

<div class="layout-main-column">
  <div class="layout-left-column">
    <%= render Shared::MobileResourcesFilterComponent.new(sdgs: @sdgs, categories: @categories, resource_name: @resource_name) %>
    <%= render 'shared/loader_spinner' %>
    <% if extended_feature?('polls.intro_text_for_polls') %>
      <%=render_custom_block 'polls_welcome' %>
    <% end %>

    <% if show_polls_description? %>
      <div class="polls-description">
        <%= auto_link_already_sanitized_html wysiwyg(@active_poll.description) %>
      </div>
    <% end %>

      <% debates_footer_url = url_for(action: params[:current_tab_path], controller: "/pages") %>
      <%= render(
            Shared::ResourcesList.new(
              resources: @polls,
              title: 'Polls',
              load_resources_url: debates_footer_url,
              map_coordinates: @polls_coordinates,
              current_filter: @current_order,
              filter_param: "order",
              filters: @valid_orders,
              no_items_text: "No proposals"
            ))
      %>
    <%= paginate @polls, remote: true, params: { controller: 'pages', action: 'voting_phase_footer_tab' } %>

    <div id="section_help" class="margin" data-magellan-target="section_help">
      <% if extended_feature?('modulewide.custom_help_text_in_modules')  %>
        <%= render_custom_block 'polls_help' %>
        <%= render_custom_partial "footer" %>
      <% end %>
    </div>
  </div>

  <div class="sidebar">
    <% unless @current_projekt.overview_page? %>
      <aside class="margin-bottom">
        <%= render Sidebar::ProjektsFilterComponent.new(
          top_level_active_projekts: @top_level_active_projekts,
          top_level_archived_projekts: @top_level_archived_projekts,
          scoped_projekt_ids: @scoped_projekt_ids,
          all_resources: @all_resources,
          current_tab_phase: @current_tab_phase,
          current_projekt: @current_projekt
        ) %>
      </aside>
    <% end %>
  </div>
</div>
