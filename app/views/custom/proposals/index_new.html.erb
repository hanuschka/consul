<h1>
  <%= t("proposals.index.title") %>
</h1>
<div class="flex-column">
  <div class="layout-left-column">
    <% if controller_name == 'proposals' %>
      <% if extended_feature?("proposals.intro_text_for_proposals") %>
        <div class="resource-page--intro-text">
          <%= render_custom_block('proposals_index_welcome', default_content: t("custom.proposals.index.welcome_default_text_html")) %>
        </div>
      <% end %>
    <% end %>
  </div>
</div>

<div class="layout-main-column">
  <div class="layout-left-column">
      <%= render(
            Shared::ResourcesList.new(
              resources: @proposals,
              resource_type: Proposal,
              current_filter: @current_order,
              filter_param: "order",
              text_search_enabled: true,
              filters: @valid_orders,
              no_items_text: "Keine Ergebnisse"
            ))
      %>
    <%= paginate @proposals %>
  </div>

  <div id="proposals-sidebar" class="sidebar">

    <% if controller_name == 'proposals' %>
      <%= render Shared::SidebarCardComponent.new(title: t('custom.common.information'), icon_name: "info-circle") do |c| %>
        <% c.body do %>
          <div class="margin-bottom-half">
            <%= render_custom_block 'projekt_overview_page_sidebar', default_content: t("custom.proposals.index.sidebar_information_default_text")  %>
          </div>
          <div class="margin-bottom-half">
            <%= Debate.count %> <%= t("custom.common.proposals") %>
          </div>

          <%= render Shared::NewButtonComponent.new(resources_name: "proposals", query_params: params) %>
        <% end %>
      <% end %>
    <% else %>
      <%= render Shared::NewButtonComponent.new(projekt_phase: @current_tab_phase) %>
    <% end %>

    <% unless @current_projekt&.overview_page? %>
      <%= render Sidebar::ProjektsFilterComponent.new(
        top_level_active_projekts: @top_level_active_projekts,
        top_level_archived_projekts: @top_level_archived_projekts,
        scoped_projekt_ids: @scoped_projekt_ids,
        all_resources: @all_resources,
        current_tab_phase: @current_tab_phase,
        current_projekt: @current_projekt
      ) %>
    <% end %>

    <%= render "shared/sidebar_filter/geozone_affiliations", resource_name: @resource_name, geozones: @geozones %>
    <%= render "shared/categories", taggable: "debate", categories: @categories %>
    <%= render SDG::FilterComponent.new("Debate") %>

    <% if extended_feature?('proposals.enable_my_posts_filter') %>
      <%= render "shared/sidebar_filter/my_posts" %>
    <% end %>

    <% if controller_name == 'proposals' && current_user&.administrator? %>
      <%= render Shared::SidebarCardComponent.new(title: 'Export', icon_name: "tag") do |c| %>
        <% c.body do %>
          <%=
            link_to t("custom.proposals.index.download_current_selection"),
              debates_path(**request.query_parameters, format: :csv),
              format: :csv,
              target: '_blank'
            %>
        <% end %>
      <% end %>
    <% end %>
  </div>
</div>
<% provide :title do %><%= t("proposals.index.title") %><% end %>
